<!DOCTYPE html>
<html lang="fr">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9299852089790980"
     crossorigin="anonymous"></script>
  <link rel="icon" href="/img/favicon.ico" sizes="any">
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Scanneur de sous domaines</title>
  <meta name="description" content="WaveTools : scanneur de sous domaines.">
  <meta name="robots" content="index, follow">
  <meta http-equiv="content-language" content="fr">
  <meta name="author" content="WaveTools">
  <link rel="canonical" href="https://www.wavetools.fr">
  <link rel="stylesheet" href="/includes/style.css">
</head>
<body>
<canvas id="siteBg"></canvas>
<script src="/includes/anime.js"></script>
<div id="header"></div>

<!-- ****************************************************************************************************** -->
<!--
<div class="tool-layout">
  <aside class="tool-ads">
    <div class="ad-box">PUB GAUCHE</div>
  </aside>
-->

<main class="tool-main">
<section class="shell-section">
<div class="ip-card">

<h1 class="tool-title">Scanner sous-domaines</h1>

<div class="terminal-body">

<div class="line">Domaine :</div>

<div class="line">
<input id="domain" style="width:100%" placeholder="example.com">
</div>

<button class="copy-btn" id="scan">
Scanner
</button>

<button class="copy-btn" id="clear">
Vider
</button>

<div class="line">Résultats :</div>

<div class="line">
<textarea id="out" rows="14" style="width:100%" readonly></textarea>
</div>

<div class="line">
Statut :
<span id="status">—</span>
</div>

<div class="line">
Note :
<span id="note">—</span>
</div>

</div>

<button class="copy-btn" id="copy">
Copier résultats
</button>

</div>
</section>
</main>


<!--
  <aside class="tool-ads">
    <div class="ad-box">PUB DROITE</div>
  </aside>
</div>
-->

<script>

const $ = id => document.getElementById(id);

function setTxt(id,v){
$(id).textContent = v || "—";
}

function setVal(id,v){
$(id).value = v || "";
}

function normalizeDomain(d){

d = (d||"")
.trim()
.toLowerCase()
.replace(/^https?:\/\//,"")
.replace(/\/.*$/,"")
.replace(/\.+$/,"");

if(!d.includes(".")) throw "Domaine invalide";

return d;

}

function uniq(arr){

return [...new Set(arr)];

}

function clean(name,domain){

let n = name
.trim()
.toLowerCase();

if(!n) return "";

n = n.replace(/\s+/g,"");


// wildcard toujours nettoyé
if(n.startsWith("*.")){

n = n.substring(2);

}

if(n===domain) return n;

if(n.endsWith("."+domain))
return n;

return "";

}


async function scan(){

setTxt("status","Scan...");
setTxt("note","Récupération CT logs crt.sh");

setVal("out","");

let domain;

try{

domain = normalizeDomain(
$("domain").value
);

}catch(e){

setTxt("status","Erreur");
setTxt("note","Domaine invalide");

return;

}

try{

// Domaine EXACT demandé
const url =
"https://crt.sh/?q="
+encodeURIComponent(domain)
+"&output=json";

const r = await fetch(url,{cache:"no-store"});

if(!r.ok)
throw "crt.sh indisponible";

const txt = await r.text();

let data;

try{

data = JSON.parse(txt);

}catch{

throw "crt.sh a renvoyé une réponse invalide (réessaie).";

}

const subs = [];

for(const it of data){

const nv =
(it && it.name_value)
? String(it.name_value)
:"";

for(const line of nv.split("\n")){

const c = clean(line,domain);

if(c)
subs.push(c);

}

}

const result =
uniq(subs)
.sort((a,b)=>a.localeCompare(b));

if(!result.length){

setTxt("status","OK");
setTxt("note","Aucun sous-domaine trouvé.");

setVal("out","(vide)");

return;

}

setVal(
"out",
result.join("\n")
);

setTxt("status","OK");

setTxt(
"note",
result.length+" sous-domaines trouvés via CT logs."
);

}catch(e){

setTxt("status","Erreur");

setTxt(
"note",
typeof e==="string"
?e
:"Impossible d'interroger crt.sh (CORS ou charge)."
);

}

}

$("scan").onclick=scan;

$("clear").onclick=()=>{

setVal("domain","");
setVal("out","");

setTxt("status","—");
setTxt("note","—");

};

$("copy").onclick=()=>{

navigator.clipboard.writeText(
$("out").value||""
);

};

  </script>

<!-- ****************************************************************************************************** -->

<div id="footer"></div>
<script src="/includes/load.js"></script>
<script src="/includes/auto.js"></script>
</body>
</html>