<!DOCTYPE html>
<html lang="fr">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9299852089790980"
     crossorigin="anonymous"></script>
  <link rel="icon" href="/img/favicon.ico" sizes="any">
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Générateur de mot de passe</title>
  <meta name="description" content="WaveTools : générateur de mot de passe.">
  <meta name="robots" content="index, follow">
  <meta http-equiv="content-language" content="fr">
  <meta name="author" content="WaveTools">
  <link rel="canonical" href="https://www.wavetools.fr">
  <link rel="stylesheet" href="/includes/style.css">
</head>
<body>
<canvas id="siteBg"></canvas>
<script src="/includes/anime.js"></script>
<div id="header"></div>

<!-- ****************************************************************************************************** -->
<!--
<div class="tool-layout">
  <aside class="tool-ads">
    <div class="ad-box">PUB GAUCHE</div>
  </aside>
-->

 <main class="tool-main">
    <section class="shell-section">
      <div class="ip-card">
        <h1 class="tool-title">Testeur de mot de passe</h1>

        <div class="terminal-body">
          <div class="line">
            Mot de passe :
            <input id="pwd" type="password" placeholder="Saisis un mot de passe" value="" />
          </div>

          <div class="line">
            <label><input id="show" type="checkbox"> afficher</label>
          </div>

          <button class="copy-btn" id="btnTest">Tester</button>

          <div class="line">Force : <span id="score">—</span></div>
          <div class="line">Longueur : <span id="len">—</span></div>
          <div class="line">Entropie (approx) : <span id="entropy">—</span></div>

          <div class="line">Critères :</div>
          <div class="line">- Minuscules : <span id="hasLower">—</span></div>
          <div class="line">- Majuscules : <span id="hasUpper">—</span></div>
          <div class="line">- Chiffres : <span id="hasDigit">—</span></div>
          <div class="line">- Symboles : <span id="hasSymbol">—</span></div>
          <div class="line">- Caractères répétés : <span id="repeats">—</span></div>
          <div class="line">- Suite simple (123 / abc) : <span id="sequences">—</span></div>

          <div class="line">Conseil : <span id="tips">—</span></div>
          <div class="line">Statut : <span id="status">—</span></div>
        </div>

        <button class="copy-btn" id="btnCopy">Copier le rapport</button>
      </div>
    </section>
  </main>


<!--
  <aside class="tool-ads">
    <div class="ad-box">PUB DROITE</div>
  </aside>
</div>
-->

<script>
 const $ = (id) => document.getElementById(id);

    function setTxt(id, v) {
      $(id).textContent = (v === undefined || v === null || v === "") ? "—" : v;
    }

    function hasLower(s){ return /[a-z]/.test(s); }
    function hasUpper(s){ return /[A-Z]/.test(s); }
    function hasDigit(s){ return /[0-9]/.test(s); }
    function hasSymbol(s){ return /[^a-zA-Z0-9]/.test(s); }

    function poolSize(s){
      let size = 0;
      if (hasLower(s)) size += 26;
      if (hasUpper(s)) size += 26;
      if (hasDigit(s)) size += 10;
      if (hasSymbol(s)) size += 32; // approx
      return size || 1;
    }

    function entropyBits(len, pool){
      return len * Math.log2(pool);
    }

    function countRepeats(s){
      if (!s) return 0;
      let rep = 0;
      for (let i = 1; i < s.length; i++){
        if (s[i] === s[i-1]) rep++;
      }
      return rep;
    }

    function hasSimpleSequence(s){
      const t = (s || "").toLowerCase();
      const seqs = ["0123456789", "abcdefghijklmnopqrstuvwxyz"];
      for (const base of seqs){
        for (let i = 0; i <= base.length - 4; i++){
          const sub = base.slice(i, i+4);
          if (t.includes(sub)) return true;
          const rev = sub.split("").reverse().join("");
          if (t.includes(rev)) return true;
        }
      }
      // claviers courants
      const common = ["qwerty", "azerty", "password", "admin"];
      return common.some(w => t.includes(w));
    }

    function scoreLabel(points){
      if (points >= 90) return "Très fort";
      if (points >= 70) return "Fort";
      if (points >= 50) return "Moyen";
      return "Faible";
    }

    function computeScore(s){
      const len = s.length;

      // base sur longueur
      let points = 0;
      if (len >= 8) points += 20;
      if (len >= 12) points += 20;
      if (len >= 16) points += 20;
      if (len >= 24) points += 10;

      // diversité
      if (hasLower(s)) points += 10;
      if (hasUpper(s)) points += 10;
      if (hasDigit(s)) points += 10;
      if (hasSymbol(s)) points += 10;

      // pénalités
      const rep = countRepeats(s);
      points -= Math.min(20, rep * 2);

      if (hasSimpleSequence(s)) points -= 25;

      // clamp
      points = Math.max(0, Math.min(100, points));
      return { points, label: scoreLabel(points) };
    }

    let lastReport = "";

    function test(){
      const s = $("pwd").value || "";
      if (!s){
        setTxt("status", "Entre un mot de passe");
        setTxt("score", "—");
        setTxt("len", "—");
        setTxt("entropy", "—");
        setTxt("hasLower", "—");
        setTxt("hasUpper", "—");
        setTxt("hasDigit", "—");
        setTxt("hasSymbol", "—");
        setTxt("repeats", "—");
        setTxt("sequences", "—");
        setTxt("tips", "—");
        lastReport = "";
        return;
      }

      const L = s.length;
      const pool = poolSize(s);
      const bits = entropyBits(L, pool);
      const rep = countRepeats(s);
      const seq = hasSimpleSequence(s);
      const sc = computeScore(s);

      setTxt("len", String(L));
      setTxt("entropy", `${Math.round(bits)} bits`);
      setTxt("score", `${sc.label} (${sc.points}/100)`);

      setTxt("hasLower", hasLower(s) ? "Oui" : "Non");
      setTxt("hasUpper", hasUpper(s) ? "Oui" : "Non");
      setTxt("hasDigit", hasDigit(s) ? "Oui" : "Non");
      setTxt("hasSymbol", hasSymbol(s) ? "Oui" : "Non");

      setTxt("repeats", rep ? `Oui (${rep})` : "Non");
      setTxt("sequences", seq ? "Oui" : "Non");

      const tips = [];
      if (L < 12) tips.push("Augmente la longueur (≥ 12).");
      if (!(hasLower(s) && hasUpper(s))) tips.push("Ajoute majuscules + minuscules.");
      if (!hasDigit(s)) tips.push("Ajoute des chiffres.");
      if (!hasSymbol(s)) tips.push("Ajoute des symboles.");
      if (seq) tips.push("Évite suites simples (1234, abcd, azerty...).");
      if (rep) tips.push("Évite répétitions (aaaa, 1111...).");
      if (!tips.length) tips.push("Très bien : garde-le unique et utilise un gestionnaire.");

      setTxt("tips", tips.join(" "));
      setTxt("status", "OK");

      lastReport =
`Test mot de passe
Force: ${sc.label} (${sc.points}/100)
Longueur: ${L}
Entropie approx: ${Math.round(bits)} bits

Critères:
- Minuscules: ${hasLower(s) ? "Oui" : "Non"}
- Majuscules: ${hasUpper(s) ? "Oui" : "Non"}
- Chiffres: ${hasDigit(s) ? "Oui" : "Non"}
- Symboles: ${hasSymbol(s) ? "Oui" : "Non"}
- Répétitions: ${rep ? "Oui ("+rep+")" : "Non"}
- Suite simple: ${seq ? "Oui" : "Non"}

Conseils:
${tips.join(" ")}
`;
    }

    $("btnTest").addEventListener("click", test);
    $("pwd").addEventListener("input", test);

    $("show").addEventListener("change", () => {
      $("pwd").type = $("show").checked ? "text" : "password";
    });

    $("btnCopy").addEventListener("click", () => {
      navigator.clipboard.writeText(lastReport || "—").catch(()=>{});
    });

    // init
    test();
  </script>

<!-- ****************************************************************************************************** -->

<div id="footer"></div>
<script src="/includes/load.js"></script>
<script src="/includes/auto.js"></script>
</body>
</html>