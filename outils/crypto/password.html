<!DOCTYPE html>
<html lang="fr">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9299852089790980"
     crossorigin="anonymous"></script>
  <link rel="icon" href="/img/favicon.ico" sizes="any">
  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Générateur de mot de passe</title>
  <meta name="description" content="WaveTools : générateur de mot de passe.">
  <meta name="robots" content="index, follow">
  <meta http-equiv="content-language" content="fr">
  <meta name="author" content="WaveTools">
  <link rel="canonical" href="https://www.wavetools.fr">
  <link rel="stylesheet" href="/includes/style.css">
</head>
<body>
<canvas id="siteBg"></canvas>
<script src="/includes/anime.js"></script>
<div id="header"></div>

<!-- ****************************************************************************************************** -->
<!--
<div class="tool-layout">
  <aside class="tool-ads">
    <div class="ad-box">PUB GAUCHE</div>
  </aside>
-->

  <main class="tool-main">
    <section class="shell-section">
      <div class="ip-card">
        <h1 class="tool-title">Générateur de mot de passe</h1>

        <div class="terminal-body">
          <div class="line">
            Longueur : <input id="len" type="number" min="6" max="128" value="16" />
          </div>

          <div class="line">
            <label><input id="lower" type="checkbox" checked> minuscules (a-z)</label>
          </div>
          <div class="line">
            <label><input id="upper" type="checkbox" checked> majuscules (A-Z)</label>
          </div>
          <div class="line">
            <label><input id="digits" type="checkbox" checked> chiffres (0-9)</label>
          </div>
          <div class="line">
            <label><input id="symbols" type="checkbox" checked> symboles (!@#...)</label>
          </div>

          <div class="line">
            <label><input id="noAmb" type="checkbox"> exclure caractères ambigus (O/0, l/1, I/1)</label>
          </div>

          <button class="copy-btn" id="btnGen">Générer</button>

          <div class="line">Mot de passe : <span id="pwd">—</span></div>
          <div class="line">Force : <span id="strength">—</span></div>
          <div class="line">Statut : <span id="status">—</span></div>
        </div>

        <button class="copy-btn" id="btnCopy">Copier</button>
      </div>
    </section>
  </main>


<!--
  <aside class="tool-ads">
    <div class="ad-box">PUB DROITE</div>
  </aside>
</div>
-->

<script>
    const $ = (id) => document.getElementById(id);

    function setTxt(id, v) {
      $(id).textContent = (v === undefined || v === null || v === "") ? "—" : v;
    }

    function cryptoRandomInt(max) {
      // entier uniformément distribué dans [0, max)
      const arr = new Uint32Array(1);
      const limit = Math.floor(0x100000000 / max) * max;
      let x;
      do {
        crypto.getRandomValues(arr);
        x = arr[0];
      } while (x >= limit);
      return x % max;
    }

    function shuffle(a) {
      for (let i = a.length - 1; i > 0; i--) {
        const j = cryptoRandomInt(i + 1);
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function buildPools() {
      let lower = "abcdefghijklmnopqrstuvwxyz";
      let upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      let digits = "0123456789";
      let symbols = "!@#$%^&*()-_=+[]{};:,.?/|~";

      if ($("noAmb").checked) {
        const amb = new Set(["O","0","l","1","I"]);
        lower = [...lower].filter(c => !amb.has(c)).join("");
        upper = [...upper].filter(c => !amb.has(c)).join("");
        digits = [...digits].filter(c => !amb.has(c)).join("");
        symbols = [...symbols].filter(c => !amb.has(c)).join("");
      }

      const groups = [];
      if ($("lower").checked) groups.push(lower);
      if ($("upper").checked) groups.push(upper);
      if ($("digits").checked) groups.push(digits);
      if ($("symbols").checked) groups.push(symbols);

      return groups;
    }

    function pickOne(str) {
      return str[cryptoRandomInt(str.length)];
    }

    function strengthLabel(len, poolSize) {
      // estimation entropy bits = len * log2(poolSize)
      const bits = len * Math.log2(poolSize || 1);
      if (bits >= 90) return "Très fort";
      if (bits >= 70) return "Fort";
      if (bits >= 50) return "Moyen";
      return "Faible";
    }

    let lastCopy = "";

    function generate() {
      const len = Math.max(6, Math.min(128, parseInt($("len").value || "16", 10)));
      $("len").value = String(len);

      const groups = buildPools();

      if (groups.length === 0) {
        setTxt("status", "Choisis au moins 1 type de caractères");
        setTxt("pwd", "—");
        setTxt("strength", "—");
        lastCopy = "";
        return;
      }

      // pool global
      const pool = groups.join("");
      if (pool.length < 2) {
        setTxt("status", "Pool trop petit");
        setTxt("pwd", "—");
        setTxt("strength", "—");
        lastCopy = "";
        return;
      }

      // assure 1 caractère par groupe sélectionné
      const out = [];
      for (const g of groups) out.push(pickOne(g));

      // complète le reste
      while (out.length < len) out.push(pickOne(pool));

      shuffle(out);

      const pwd = out.join("");
      setTxt("pwd", pwd);
      setTxt("strength", strengthLabel(len, pool.length));
      setTxt("status", "OK");

      lastCopy = pwd;
    }

    $("btnGen").addEventListener("click", generate);
    $("btnCopy").addEventListener("click", () => {
      navigator.clipboard.writeText(lastCopy || "—").catch(()=>{});
    });

    // auto au chargement
    generate();
  </script>

<!-- ****************************************************************************************************** -->

<div id="footer"></div>
<script src="/includes/load.js"></script>
<script src="/includes/auto.js"></script>
</body>
</html>